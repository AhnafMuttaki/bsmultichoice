{"version":3,"sources":["../src/clearchoice.js"],"names":["define","$","CustomEvents","SELECTORS","CHOICE_ELEMENT","LINK","RADIO","checkClearChoiceRadio","clearChoiceContainer","find","prop","getClearChoiceElement","root","fieldPrefix","hideClearChoiceOption","addClass","attr","showClearChoiceOption","removeClass","removeAttr","registerEventListeners","on","events","activate","e","data","originalEvent","preventDefault","focus","firstChoice","first","init"],"mappings":"AAuBAA,OAAM,mCAAC,CAAC,QAAD,CAAW,gCAAX,CAAD,CAA+C,SAASC,CAAT,CAAYC,CAAZ,CAA0B,IAEvEC,CAAAA,CAAS,CAAG,CACZC,cAAc,CAAE,eADJ,CAEZC,IAAI,CAAE,GAFM,CAGZC,KAAK,CAAE,uBAHK,CAF2D,CAavEC,CAAqB,CAAG,SAASC,CAAT,CAA+B,CACvDA,CAAoB,CAACC,IAArB,CAA0BN,CAAS,CAACG,KAApC,EAA2CI,IAA3C,CAAgD,UAAhD,KAAmEA,IAAnE,CAAwE,SAAxE,IACH,CAf0E,CAwBvEC,CAAqB,CAAG,SAASC,CAAT,CAAeC,CAAf,CAA4B,CACpD,MAAOD,CAAAA,CAAI,CAACH,IAAL,CAAU,YAAaI,CAAb,CAA2B,KAArC,CACV,CA1B0E,CAiCvEC,CAAqB,CAAG,SAASN,CAAT,CAA+B,CAGvDA,CAAoB,CAACO,QAArB,CAA8B,SAA9B,EACAP,CAAoB,CAACQ,IAArB,CAA0B,aAA1B,KACAR,CAAoB,CAACC,IAArB,CAA0BN,CAAS,CAACE,IAApC,EAA0CW,IAA1C,CAA+C,UAA/C,CAA2D,CAAC,CAA5D,CACH,CAvC0E,CA8CvEC,CAAqB,CAAG,SAAST,CAAT,CAA+B,CACvDA,CAAoB,CAACU,WAArB,CAAiC,SAAjC,EACAV,CAAoB,CAACW,UAArB,CAAgC,aAAhC,EACAX,CAAoB,CAACC,IAArB,CAA0BN,CAAS,CAACE,IAApC,EAA0CW,IAA1C,CAA+C,UAA/C,CAA2D,CAA3D,EACAR,CAAoB,CAACC,IAArB,CAA0BN,CAAS,CAACG,KAApC,EAA2CI,IAA3C,CAAgD,UAAhD,IACH,CAnD0E,CA2DvEU,CAAsB,CAAG,SAASR,CAAT,CAAeC,CAAf,CAA4B,CACrD,GAAIL,CAAAA,CAAoB,CAAGG,CAAqB,CAACC,CAAD,CAAOC,CAAP,CAAhD,CAEAL,CAAoB,CAACa,EAArB,CAAwBnB,CAAY,CAACoB,MAAb,CAAoBC,QAA5C,CAAsDpB,CAAS,CAACE,IAAhE,CAAsE,SAASmB,CAAT,CAAYC,CAAZ,CAAkB,CAGhFlB,CAAqB,CAACC,CAAD,CAArB,CAEAM,CAAqB,CAACN,CAAD,CAArB,CAEAiB,CAAI,CAACC,aAAL,CAAmBC,cAAnB,EACP,CARD,EAUAf,CAAI,CAACS,EAAL,CAAQ,QAAR,CAAkBlB,CAAS,CAACC,cAA5B,CAA4C,UAAW,CAEnDa,CAAqB,CAACT,CAAD,CACxB,CAHD,EAOAA,CAAoB,CAACC,IAArB,CAA0BN,CAAS,CAACG,KAApC,EAA2CsB,KAA3C,CAAiD,UAAW,CACxD,GAAIC,CAAAA,CAAW,CAAGjB,CAAI,CAACH,IAAL,CAAUN,CAAS,CAACC,cAApB,EAAoC0B,KAApC,EAAlB,CACAD,CAAW,CAACD,KAAZ,EACH,CAHD,CAIH,CAnF0E,CAgG3E,MAAO,CACHG,IAAI,CANG,QAAPA,CAAAA,IAAO,CAASnB,CAAT,CAAeC,CAAf,CAA4B,CACnCD,CAAI,CAAGX,CAAC,CAAC,IAAMW,CAAP,CAAR,CACAQ,CAAsB,CAACR,CAAD,CAAOC,CAAP,CACzB,CAEM,CAGV,CAnGK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Manages 'Clear my choice' functionality actions.\r\n *\r\n * @module     qtype_bsmultichoice/clearchoice\r\n * @copyright  2019 Simey Lameze <simey@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @since      3.7\r\n */\r\ndefine(['jquery', 'core/custom_interaction_events'], function($, CustomEvents) {\r\n\r\n    var SELECTORS = {\r\n        CHOICE_ELEMENT: '.answer input',\r\n        LINK: 'a',\r\n        RADIO: 'input[type=\"radio\"]'\r\n    };\r\n\r\n    /**\r\n     * Mark clear choice radio as enabled and checked.\r\n     *\r\n     * @param {Object} clearChoiceContainer The clear choice option container.\r\n     */\r\n    var checkClearChoiceRadio = function(clearChoiceContainer) {\r\n        clearChoiceContainer.find(SELECTORS.RADIO).prop('disabled', false).prop('checked', true);\r\n    };\r\n\r\n    /**\r\n     * Get the clear choice div container.\r\n     *\r\n     * @param {Object} root The question root element.\r\n     * @param {string} fieldPrefix The question outer div prefix.\r\n     * @returns {Object} The clear choice div container.\r\n     */\r\n    var getClearChoiceElement = function(root, fieldPrefix) {\r\n        return root.find('div[id=\"' + fieldPrefix + '\"]');\r\n    };\r\n\r\n    /**\r\n     * Hide clear choice option.\r\n     *\r\n     * @param {Object} clearChoiceContainer The clear choice option container.\r\n     */\r\n    var hideClearChoiceOption = function(clearChoiceContainer) {\r\n        // We are using .sr-only and aria-hidden together so while the element is hidden\r\n        // from both the monitor and the screen-reader, it is still tabbable.\r\n        clearChoiceContainer.addClass('sr-only');\r\n        clearChoiceContainer.attr('aria-hidden', true);\r\n        clearChoiceContainer.find(SELECTORS.LINK).attr('tabindex', -1);\r\n    };\r\n\r\n    /**\r\n     * Shows clear choice option.\r\n     *\r\n     * @param {Object} clearChoiceContainer The clear choice option container.\r\n     */\r\n    var showClearChoiceOption = function(clearChoiceContainer) {\r\n        clearChoiceContainer.removeClass('sr-only');\r\n        clearChoiceContainer.removeAttr('aria-hidden');\r\n        clearChoiceContainer.find(SELECTORS.LINK).attr('tabindex', 0);\r\n        clearChoiceContainer.find(SELECTORS.RADIO).prop('disabled', true);\r\n    };\r\n\r\n    /**\r\n     * Register event listeners for the clear choice module.\r\n     *\r\n     * @param {Object} root The question outer div prefix.\r\n     * @param {string} fieldPrefix The \"Clear choice\" div prefix.\r\n     */\r\n    var registerEventListeners = function(root, fieldPrefix) {\r\n        var clearChoiceContainer = getClearChoiceElement(root, fieldPrefix);\r\n\r\n        clearChoiceContainer.on(CustomEvents.events.activate, SELECTORS.LINK, function(e, data) {\r\n\r\n                // Mark the clear choice radio element as checked.\r\n                checkClearChoiceRadio(clearChoiceContainer);\r\n                // Now that the hidden radio has been checked, hide the clear choice option.\r\n                hideClearChoiceOption(clearChoiceContainer);\r\n\r\n                data.originalEvent.preventDefault();\r\n        });\r\n\r\n        root.on('change', SELECTORS.CHOICE_ELEMENT, function() {\r\n            // If the event has been triggered by any other choice, show the clear choice option.\r\n            showClearChoiceOption(clearChoiceContainer);\r\n        });\r\n\r\n        // If the clear choice radio receives focus from using the tab key, return the focus\r\n        // to the first answer option.\r\n        clearChoiceContainer.find(SELECTORS.RADIO).focus(function() {\r\n            var firstChoice = root.find(SELECTORS.CHOICE_ELEMENT).first();\r\n            firstChoice.focus();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Initialise clear choice module.\r\n\r\n     * @param {string} root The question outer div prefix.\r\n     * @param {string} fieldPrefix The \"Clear choice\" div prefix.\r\n     */\r\n    var init = function(root, fieldPrefix) {\r\n        root = $('#' + root);\r\n        registerEventListeners(root, fieldPrefix);\r\n    };\r\n\r\n    return {\r\n        init: init\r\n    };\r\n});\r\n"],"file":"clearchoice.min.js"}